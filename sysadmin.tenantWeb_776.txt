2022-12-08 15:35:09.004 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000012-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"fb508a8258c07656","TraceId":"0d1bb7130d5e3f5927283e90f917ebf5","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:09.020 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000012-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"fb508a8258c07656","TraceId":"0d1bb7130d5e3f5927283e90f917ebf5","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:09.021 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 10> {"SpanId":"fb508a8258c07656","TraceId":"0d1bb7130d5e3f5927283e90f917ebf5","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000012-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:09.721 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 10> {"SpanId":"fb508a8258c07656","TraceId":"0d1bb7130d5e3f5927283e90f917ebf5","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000012-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:35:09.895 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 930.1224 ms <PID: 277684, Thread: 77> {"SpanId":"fb508a8258c07656","TraceId":"0d1bb7130d5e3f5927283e90f917ebf5","ParentId":"0000000000000000","RequestId":"80000012-0003-f500-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:09.949 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000914-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"7541d5471dd9da9d","TraceId":"7b700985a753d67d0584facc3ee8e4bf","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:09.951 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000914-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"7541d5471dd9da9d","TraceId":"7b700985a753d67d0584facc3ee8e4bf","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:09.981 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 63.5822 ms <PID: 277684, Thread: 119> {"SpanId":"7541d5471dd9da9d","TraceId":"7b700985a753d67d0584facc3ee8e4bf","ParentId":"0000000000000000","RequestId":"80000914-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:52.448 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 53> {"SpanId":"97c1265055e6ef25","TraceId":"3b82ea578fd4a118afaf1666561e199c","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000464-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:35:52.739 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625727 responded 500 in 1499.0001 ms <PID: 277684, Thread: 53> {"SpanId":"97c1265055e6ef25","TraceId":"3b82ea578fd4a118afaf1666561e199c","ParentId":"0000000000000000","RequestId":"80000464-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:35:52.752 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 53> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000464-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"97c1265055e6ef25","TraceId":"3b82ea578fd4a118afaf1666561e199c","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:35:52.761 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 53> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000464-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"97c1265055e6ef25","TraceId":"3b82ea578fd4a118afaf1666561e199c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:35:53.173 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755285", Request ID "80000464-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 53> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000464-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"97c1265055e6ef25","TraceId":"3b82ea578fd4a118afaf1666561e199c","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:36:09.021 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 205> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000662-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"077deeb218ace9ac","TraceId":"c4c88d9e543ecd7ab7d211269786a935","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:09.022 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 205> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000662-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"077deeb218ace9ac","TraceId":"c4c88d9e543ecd7ab7d211269786a935","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:09.022 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 205> {"SpanId":"077deeb218ace9ac","TraceId":"c4c88d9e543ecd7ab7d211269786a935","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000662-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:09.674 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 205> {"SpanId":"077deeb218ace9ac","TraceId":"c4c88d9e543ecd7ab7d211269786a935","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000662-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:36:09.797 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 825.4159 ms <PID: 277684, Thread: 10> {"SpanId":"077deeb218ace9ac","TraceId":"c4c88d9e543ecd7ab7d211269786a935","ParentId":"0000000000000000","RequestId":"80000662-0005-fb00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:09.851 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000916-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"4e4e341353961045","TraceId":"16948c5975c43a59023317decdc271e6","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:09.852 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000916-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"4e4e341353961045","TraceId":"16948c5975c43a59023317decdc271e6","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:09.876 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 50.1232 ms <PID: 277684, Thread: 77> {"SpanId":"4e4e341353961045","TraceId":"16948c5975c43a59023317decdc271e6","ParentId":"0000000000000000","RequestId":"80000916-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:52.466 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 53> {"SpanId":"bfa4576eb6fb1a60","TraceId":"77b696d1d36dd8464560887f8756ebb8","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800002ee-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:36:52.750 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625729 responded 500 in 1510.7396 ms <PID: 277684, Thread: 53> {"SpanId":"bfa4576eb6fb1a60","TraceId":"77b696d1d36dd8464560887f8756ebb8","ParentId":"0000000000000000","RequestId":"800002ee-0000-fa00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:36:52.765 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 53> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800002ee-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"bfa4576eb6fb1a60","TraceId":"77b696d1d36dd8464560887f8756ebb8","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:36:52.776 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 53> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800002ee-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"bfa4576eb6fb1a60","TraceId":"77b696d1d36dd8464560887f8756ebb8","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:36:53.129 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18014398511092597470", Request ID "800002ee-0000-fa00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 53> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800002ee-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"bfa4576eb6fb1a60","TraceId":"77b696d1d36dd8464560887f8756ebb8","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:37:09.016 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000378-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"aa66157403aac36a","TraceId":"e787583d4bc6e9841c8cc5ebdb237709","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:09.017 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000378-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"aa66157403aac36a","TraceId":"e787583d4bc6e9841c8cc5ebdb237709","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:09.018 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 77> {"SpanId":"aa66157403aac36a","TraceId":"e787583d4bc6e9841c8cc5ebdb237709","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000378-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:09.737 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 77> {"SpanId":"aa66157403aac36a","TraceId":"e787583d4bc6e9841c8cc5ebdb237709","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000378-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:37:09.908 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 935.5825 ms <PID: 277684, Thread: 10> {"SpanId":"aa66157403aac36a","TraceId":"e787583d4bc6e9841c8cc5ebdb237709","ParentId":"0000000000000000","RequestId":"80000378-0006-f700-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:09.939 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000918-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"6733a208b95e49e8","TraceId":"bdf46088c290a5b1d2cf2ffcaf34bd99","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:09.940 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000918-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"6733a208b95e49e8","TraceId":"bdf46088c290a5b1d2cf2ffcaf34bd99","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:09.974 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 64.3570 ms <PID: 277684, Thread: 205> {"SpanId":"6733a208b95e49e8","TraceId":"bdf46088c290a5b1d2cf2ffcaf34bd99","ParentId":"0000000000000000","RequestId":"80000918-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:52.488 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 112> {"SpanId":"d3458c2a5a80ab50","TraceId":"7799f61d417d73ff5e93be59d502a94a","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800002ef-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:37:52.780 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625731 responded 500 in 1540.4973 ms <PID: 277684, Thread: 112> {"SpanId":"d3458c2a5a80ab50","TraceId":"7799f61d417d73ff5e93be59d502a94a","ParentId":"0000000000000000","RequestId":"800002ef-0000-fa00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:37:52.801 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 112> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800002ef-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d3458c2a5a80ab50","TraceId":"7799f61d417d73ff5e93be59d502a94a","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:37:52.810 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 112> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800002ef-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d3458c2a5a80ab50","TraceId":"7799f61d417d73ff5e93be59d502a94a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:37:53.224 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18014398511092597470", Request ID "800002ef-0000-fa00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 112> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800002ef-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d3458c2a5a80ab50","TraceId":"7799f61d417d73ff5e93be59d502a94a","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:38:08.987 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 119> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"800000c2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"f7cc56a3a37303ea","TraceId":"ba3895b52145347ff13508d565fffe00","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:08.987 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 119> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"800000c2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"f7cc56a3a37303ea","TraceId":"ba3895b52145347ff13508d565fffe00","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:08.988 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 119> {"SpanId":"f7cc56a3a37303ea","TraceId":"ba3895b52145347ff13508d565fffe00","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"800000c2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:09.565 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 119> {"SpanId":"f7cc56a3a37303ea","TraceId":"ba3895b52145347ff13508d565fffe00","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"800000c2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:38:09.706 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 754.6627 ms <PID: 277684, Thread: 32> {"SpanId":"f7cc56a3a37303ea","TraceId":"ba3895b52145347ff13508d565fffe00","ParentId":"0000000000000000","RequestId":"800000c2-0007-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:09.754 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 32> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000037a-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"f228fc52276a1671","TraceId":"077baa65ec23119f553fca764090a54a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:09.755 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 32> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000037a-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"f228fc52276a1671","TraceId":"077baa65ec23119f553fca764090a54a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:09.792 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 70.9809 ms <PID: 277684, Thread: 141> {"SpanId":"f228fc52276a1671","TraceId":"077baa65ec23119f553fca764090a54a","ParentId":"0000000000000000","RequestId":"8000037a-0006-f700-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:52.435 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"e8162f9ea629d376","TraceId":"ff5671ae331acc5b675dad8743afb55a","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000116-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:38:52.729 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625733 responded 500 in 1489.8143 ms <PID: 277684, Thread: 7> {"SpanId":"e8162f9ea629d376","TraceId":"ff5671ae331acc5b675dad8743afb55a","ParentId":"0000000000000000","RequestId":"80000116-0003-f800-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:38:52.742 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000116-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e8162f9ea629d376","TraceId":"ff5671ae331acc5b675dad8743afb55a","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:38:52.751 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000116-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e8162f9ea629d376","TraceId":"ff5671ae331acc5b675dad8743afb55a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:38:53.149 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17870283335901643012", Request ID "80000116-0003-f800-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000116-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e8162f9ea629d376","TraceId":"ff5671ae331acc5b675dad8743afb55a","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:39:09.013 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000131-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"6e549a75a4ca30e0","TraceId":"c05edafb5f131800420bdc7af6517b9d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:09.014 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000131-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"6e549a75a4ca30e0","TraceId":"c05edafb5f131800420bdc7af6517b9d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:09.015 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 86> {"SpanId":"6e549a75a4ca30e0","TraceId":"c05edafb5f131800420bdc7af6517b9d","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000131-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:09.721 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 86> {"SpanId":"6e549a75a4ca30e0","TraceId":"c05edafb5f131800420bdc7af6517b9d","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000131-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:39:09.905 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 932.1608 ms <PID: 277684, Thread: 80> {"SpanId":"6e549a75a4ca30e0","TraceId":"c05edafb5f131800420bdc7af6517b9d","ParentId":"0000000000000000","RequestId":"80000131-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:09.963 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 80> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000133-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"ed9d476fcd6881b8","TraceId":"6ae1205ce67cffe35cbf42d9f2c024de","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:09.964 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 80> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000133-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"ed9d476fcd6881b8","TraceId":"6ae1205ce67cffe35cbf42d9f2c024de","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:10.001 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 72.4600 ms <PID: 277684, Thread: 32> {"SpanId":"ed9d476fcd6881b8","TraceId":"6ae1205ce67cffe35cbf42d9f2c024de","ParentId":"0000000000000000","RequestId":"80000133-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:52.450 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"a9ea8fc85672550a","TraceId":"1ddcc14bddb1dbb57301c311fd979ca9","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800002f1-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:39:52.716 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625735 responded 500 in 1476.5649 ms <PID: 277684, Thread: 7> {"SpanId":"a9ea8fc85672550a","TraceId":"1ddcc14bddb1dbb57301c311fd979ca9","ParentId":"0000000000000000","RequestId":"800002f1-0000-fa00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:39:52.737 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800002f1-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"a9ea8fc85672550a","TraceId":"1ddcc14bddb1dbb57301c311fd979ca9","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:39:52.747 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800002f1-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"a9ea8fc85672550a","TraceId":"1ddcc14bddb1dbb57301c311fd979ca9","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:39:53.128 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18014398511092597470", Request ID "800002f1-0000-fa00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800002f1-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"a9ea8fc85672550a","TraceId":"1ddcc14bddb1dbb57301c311fd979ca9","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:40:09.252 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 20> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000040-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"b2707c29db8e3c1a","TraceId":"2644a500bcf9239d80cebc2870dab07d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:09.253 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 20> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000040-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"b2707c29db8e3c1a","TraceId":"2644a500bcf9239d80cebc2870dab07d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:09.253 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 20> {"SpanId":"b2707c29db8e3c1a","TraceId":"2644a500bcf9239d80cebc2870dab07d","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000040-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:09.853 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 20> {"SpanId":"b2707c29db8e3c1a","TraceId":"2644a500bcf9239d80cebc2870dab07d","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000040-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:40:09.981 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 770.7929 ms <PID: 277684, Thread: 119> {"SpanId":"b2707c29db8e3c1a","TraceId":"2644a500bcf9239d80cebc2870dab07d","ParentId":"0000000000000000","RequestId":"80000040-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:10.030 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 119> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000042-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"e3375a7da1ed97fc","TraceId":"11a4d17ef6cb98bd057bead028fc197d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:10.031 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 119> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000042-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"e3375a7da1ed97fc","TraceId":"11a4d17ef6cb98bd057bead028fc197d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:10.068 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 68.2001 ms <PID: 277684, Thread: 17> {"SpanId":"e3375a7da1ed97fc","TraceId":"11a4d17ef6cb98bd057bead028fc197d","ParentId":"0000000000000000","RequestId":"80000042-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:52.475 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 50> {"SpanId":"ec225931d785f05e","TraceId":"bba5c3181e7d36ece3847969045b843c","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800002f2-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:40:52.748 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625737 responded 500 in 1509.6076 ms <PID: 277684, Thread: 50> {"SpanId":"ec225931d785f05e","TraceId":"bba5c3181e7d36ece3847969045b843c","ParentId":"0000000000000000","RequestId":"800002f2-0000-fa00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:40:52.765 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 50> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800002f2-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ec225931d785f05e","TraceId":"bba5c3181e7d36ece3847969045b843c","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:40:52.772 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 50> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800002f2-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ec225931d785f05e","TraceId":"bba5c3181e7d36ece3847969045b843c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:40:53.178 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18014398511092597470", Request ID "800002f2-0000-fa00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 50> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800002f2-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ec225931d785f05e","TraceId":"bba5c3181e7d36ece3847969045b843c","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:41:09.018 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 102> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000091a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"658d8a6b83cced97","TraceId":"5b92c116ce4a03635a00b651e3bf2fce","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:09.019 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 102> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000091a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"658d8a6b83cced97","TraceId":"5b92c116ce4a03635a00b651e3bf2fce","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:09.020 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 102> {"SpanId":"658d8a6b83cced97","TraceId":"5b92c116ce4a03635a00b651e3bf2fce","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000091a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:09.738 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 102> {"SpanId":"658d8a6b83cced97","TraceId":"5b92c116ce4a03635a00b651e3bf2fce","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000091a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:41:09.895 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 919.7621 ms <PID: 277684, Thread: 119> {"SpanId":"658d8a6b83cced97","TraceId":"5b92c116ce4a03635a00b651e3bf2fce","ParentId":"0000000000000000","RequestId":"8000091a-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:09.954 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 119> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800003ce-0000-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"5f94d4c4cd1ed18d","TraceId":"41fb6a846b53d35c3ddb2adbd6344943","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:09.955 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 119> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800003ce-0000-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"5f94d4c4cd1ed18d","TraceId":"41fb6a846b53d35c3ddb2adbd6344943","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:09.992 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 76.2645 ms <PID: 277684, Thread: 86> {"SpanId":"5f94d4c4cd1ed18d","TraceId":"41fb6a846b53d35c3ddb2adbd6344943","ParentId":"0000000000000000","RequestId":"800003ce-0000-fc00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:52.446 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"79e7d6203663d56f","TraceId":"4f32d96122972b0f17eb06ebbacba5b1","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000119-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:41:52.745 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625739 responded 500 in 1506.6759 ms <PID: 277684, Thread: 7> {"SpanId":"79e7d6203663d56f","TraceId":"4f32d96122972b0f17eb06ebbacba5b1","ParentId":"0000000000000000","RequestId":"80000119-0003-f800-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:41:52.761 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000119-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"79e7d6203663d56f","TraceId":"4f32d96122972b0f17eb06ebbacba5b1","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:41:52.773 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000119-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"79e7d6203663d56f","TraceId":"4f32d96122972b0f17eb06ebbacba5b1","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:41:53.146 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17870283335901643012", Request ID "80000119-0003-f800-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000119-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"79e7d6203663d56f","TraceId":"4f32d96122972b0f17eb06ebbacba5b1","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:42:08.990 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 32> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000044-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"a325cdb19d79d626","TraceId":"13786f7be036d3449f20d4a1fd74441a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:08.991 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 32> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000044-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"a325cdb19d79d626","TraceId":"13786f7be036d3449f20d4a1fd74441a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:08.992 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 32> {"SpanId":"a325cdb19d79d626","TraceId":"13786f7be036d3449f20d4a1fd74441a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000044-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:09.553 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 32> {"SpanId":"a325cdb19d79d626","TraceId":"13786f7be036d3449f20d4a1fd74441a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000044-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:42:09.691 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 738.1639 ms <PID: 277684, Thread: 102> {"SpanId":"a325cdb19d79d626","TraceId":"13786f7be036d3449f20d4a1fd74441a","ParentId":"0000000000000000","RequestId":"80000044-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:09.759 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 102> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000046-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9cb24dc1676b8cba","TraceId":"832c322a60f858408ccc5be94443490f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:09.760 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 102> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000046-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9cb24dc1676b8cba","TraceId":"832c322a60f858408ccc5be94443490f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:09.794 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 72.5629 ms <PID: 277684, Thread: 218> {"SpanId":"9cb24dc1676b8cba","TraceId":"832c322a60f858408ccc5be94443490f","ParentId":"0000000000000000","RequestId":"80000046-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:52.476 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"e590789da00f2bad","TraceId":"38e6276e5514beba0a372a033f75919c","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000011a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:42:52.795 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625741 responded 500 in 1556.0086 ms <PID: 277684, Thread: 7> {"SpanId":"e590789da00f2bad","TraceId":"38e6276e5514beba0a372a033f75919c","ParentId":"0000000000000000","RequestId":"8000011a-0003-f800-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:42:52.829 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000011a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e590789da00f2bad","TraceId":"38e6276e5514beba0a372a033f75919c","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:42:52.838 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000011a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e590789da00f2bad","TraceId":"38e6276e5514beba0a372a033f75919c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:42:53.271 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17870283335901643012", Request ID "8000011a-0003-f800-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000011a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e590789da00f2bad","TraceId":"38e6276e5514beba0a372a033f75919c","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:43:09.026 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000664-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"3b95b6d16a39104f","TraceId":"879337a818fd158492d254e67b0b9f8a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:09.027 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000664-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"3b95b6d16a39104f","TraceId":"879337a818fd158492d254e67b0b9f8a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:09.027 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 86> {"SpanId":"3b95b6d16a39104f","TraceId":"879337a818fd158492d254e67b0b9f8a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000664-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:09.704 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 86> {"SpanId":"3b95b6d16a39104f","TraceId":"879337a818fd158492d254e67b0b9f8a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000664-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:43:09.894 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 913.1741 ms <PID: 277684, Thread: 142> {"SpanId":"3b95b6d16a39104f","TraceId":"879337a818fd158492d254e67b0b9f8a","ParentId":"0000000000000000","RequestId":"80000664-0005-fb00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:09.965 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 142> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000091c-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9d51936bfc9ca626","TraceId":"321a2aaf5ac3c73828d11f445777e506","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:09.965 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 142> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000091c-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9d51936bfc9ca626","TraceId":"321a2aaf5ac3c73828d11f445777e506","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:10.002 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 76.9447 ms <PID: 277684, Thread: 86> {"SpanId":"9d51936bfc9ca626","TraceId":"321a2aaf5ac3c73828d11f445777e506","ParentId":"0000000000000000","RequestId":"8000091c-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:52.430 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"43c8001935806d8c","TraceId":"8690957f10981d9a31fcdca3d3dcffc7","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800002f5-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:43:52.713 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625743 responded 500 in 1476.2514 ms <PID: 277684, Thread: 7> {"SpanId":"43c8001935806d8c","TraceId":"8690957f10981d9a31fcdca3d3dcffc7","ParentId":"0000000000000000","RequestId":"800002f5-0000-fa00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:43:52.720 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800002f5-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"43c8001935806d8c","TraceId":"8690957f10981d9a31fcdca3d3dcffc7","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:43:52.728 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800002f5-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"43c8001935806d8c","TraceId":"8690957f10981d9a31fcdca3d3dcffc7","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:43:53.073 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18014398511092597470", Request ID "800002f5-0000-fa00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800002f5-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"43c8001935806d8c","TraceId":"8690957f10981d9a31fcdca3d3dcffc7","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:44:08.983 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 32> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000014-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"96fa0dbc29467042","TraceId":"0aed57150ce92478cf360dba0a288d8b","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:08.984 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 32> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000014-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"96fa0dbc29467042","TraceId":"0aed57150ce92478cf360dba0a288d8b","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:08.985 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 32> {"SpanId":"96fa0dbc29467042","TraceId":"0aed57150ce92478cf360dba0a288d8b","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000014-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:09.597 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 32> {"SpanId":"96fa0dbc29467042","TraceId":"0aed57150ce92478cf360dba0a288d8b","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000014-0003-f500-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:44:09.772 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 830.6298 ms <PID: 277684, Thread: 102> {"SpanId":"96fa0dbc29467042","TraceId":"0aed57150ce92478cf360dba0a288d8b","ParentId":"0000000000000000","RequestId":"80000014-0003-f500-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:09.829 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000135-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"02afee5679085c31","TraceId":"d7f7da75fddfca83070c7d8b2c5a9486","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:09.830 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000135-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"02afee5679085c31","TraceId":"d7f7da75fddfca83070c7d8b2c5a9486","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:09.868 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 75.1645 ms <PID: 277684, Thread: 32> {"SpanId":"02afee5679085c31","TraceId":"d7f7da75fddfca83070c7d8b2c5a9486","ParentId":"0000000000000000","RequestId":"80000135-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:52.434 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"55e5460becec68a5","TraceId":"a8c815fe0cea959501fff48f88ffec74","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000011c-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:44:52.712 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625745 responded 500 in 1471.0268 ms <PID: 277684, Thread: 7> {"SpanId":"55e5460becec68a5","TraceId":"a8c815fe0cea959501fff48f88ffec74","ParentId":"0000000000000000","RequestId":"8000011c-0003-f800-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:44:52.721 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000011c-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"55e5460becec68a5","TraceId":"a8c815fe0cea959501fff48f88ffec74","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:44:52.729 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000011c-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"55e5460becec68a5","TraceId":"a8c815fe0cea959501fff48f88ffec74","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:44:53.142 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17870283335901643012", Request ID "8000011c-0003-f800-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000011c-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"55e5460becec68a5","TraceId":"a8c815fe0cea959501fff48f88ffec74","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:45:09.010 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000048-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"dd45fe9bf5564b50","TraceId":"4832b99fede37bb0ae6a7f2591645394","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:09.011 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000048-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"dd45fe9bf5564b50","TraceId":"4832b99fede37bb0ae6a7f2591645394","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:09.012 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 86> {"SpanId":"dd45fe9bf5564b50","TraceId":"4832b99fede37bb0ae6a7f2591645394","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000048-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:09.670 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 86> {"SpanId":"dd45fe9bf5564b50","TraceId":"4832b99fede37bb0ae6a7f2591645394","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000048-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:45:09.845 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 875.3145 ms <PID: 277684, Thread: 102> {"SpanId":"dd45fe9bf5564b50","TraceId":"4832b99fede37bb0ae6a7f2591645394","ParentId":"0000000000000000","RequestId":"80000048-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:09.910 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 102> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000037c-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"0e3f92a903c01439","TraceId":"5f644fc55ae1fc15603b986f7359f85f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:09.911 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 102> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000037c-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"0e3f92a903c01439","TraceId":"5f644fc55ae1fc15603b986f7359f85f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:09.946 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 76.6634 ms <PID: 277684, Thread: 221> {"SpanId":"0e3f92a903c01439","TraceId":"5f644fc55ae1fc15603b986f7359f85f","ParentId":"0000000000000000","RequestId":"8000037c-0006-f700-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:52.456 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"3502d313a7934946","TraceId":"ccc543aebb4cbb1325097e46d5f4420a","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000011d-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:45:52.755 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625747 responded 500 in 1516.1391 ms <PID: 277684, Thread: 7> {"SpanId":"3502d313a7934946","TraceId":"ccc543aebb4cbb1325097e46d5f4420a","ParentId":"0000000000000000","RequestId":"8000011d-0003-f800-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:45:52.768 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000011d-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3502d313a7934946","TraceId":"ccc543aebb4cbb1325097e46d5f4420a","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:45:52.782 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000011d-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3502d313a7934946","TraceId":"ccc543aebb4cbb1325097e46d5f4420a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:45:53.184 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17870283335901643012", Request ID "8000011d-0003-f800-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000011d-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3502d313a7934946","TraceId":"ccc543aebb4cbb1325097e46d5f4420a","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:46:09.027 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000004a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"cda0e07ca771f418","TraceId":"cba6b14f41334f760bd4f36ee45bad57","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:09.028 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 86> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000004a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"cda0e07ca771f418","TraceId":"cba6b14f41334f760bd4f36ee45bad57","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:09.028 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 86> {"SpanId":"cda0e07ca771f418","TraceId":"cba6b14f41334f760bd4f36ee45bad57","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000004a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:09.665 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 86> {"SpanId":"cda0e07ca771f418","TraceId":"cba6b14f41334f760bd4f36ee45bad57","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000004a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:46:09.831 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 848.2138 ms <PID: 277684, Thread: 163> {"SpanId":"cda0e07ca771f418","TraceId":"cba6b14f41334f760bd4f36ee45bad57","ParentId":"0000000000000000","RequestId":"8000004a-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:09.880 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 229> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000004c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"ae4d3b2bd92c51d2","TraceId":"e83ee7c8fd59d8dcbeb4ca77a2beaf34","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:09.880 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 229> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000004c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"ae4d3b2bd92c51d2","TraceId":"e83ee7c8fd59d8dcbeb4ca77a2beaf34","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:09.913 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 52.0558 ms <PID: 277684, Thread: 181> {"SpanId":"ae4d3b2bd92c51d2","TraceId":"e83ee7c8fd59d8dcbeb4ca77a2beaf34","ParentId":"0000000000000000","RequestId":"8000004c-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:52.450 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"4a4bb229e5942502","TraceId":"fc5db9a185e2f4cab71d91872bfc22e0","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800002f8-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:46:52.733 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625749 responded 500 in 1494.6872 ms <PID: 277684, Thread: 7> {"SpanId":"4a4bb229e5942502","TraceId":"fc5db9a185e2f4cab71d91872bfc22e0","ParentId":"0000000000000000","RequestId":"800002f8-0000-fa00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:46:52.746 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800002f8-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4a4bb229e5942502","TraceId":"fc5db9a185e2f4cab71d91872bfc22e0","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:46:52.754 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800002f8-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4a4bb229e5942502","TraceId":"fc5db9a185e2f4cab71d91872bfc22e0","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:46:53.148 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18014398511092597470", Request ID "800002f8-0000-fa00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800002f8-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4a4bb229e5942502","TraceId":"fc5db9a185e2f4cab71d91872bfc22e0","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:47:09.263 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000137-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"de4a353832649585","TraceId":"5935837dfc4ed2bdb08057d51d3bb90d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:09.264 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000137-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"de4a353832649585","TraceId":"5935837dfc4ed2bdb08057d51d3bb90d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:09.264 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 10> {"SpanId":"de4a353832649585","TraceId":"5935837dfc4ed2bdb08057d51d3bb90d","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000137-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:09.901 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 10> {"SpanId":"de4a353832649585","TraceId":"5935837dfc4ed2bdb08057d51d3bb90d","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000137-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:47:10.046 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 815.2670 ms <PID: 277684, Thread: 205> {"SpanId":"de4a353832649585","TraceId":"5935837dfc4ed2bdb08057d51d3bb90d","ParentId":"0000000000000000","RequestId":"80000137-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:10.114 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000091e-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"f8fabe6ad86e7460","TraceId":"b81205db5df4a726ec980947b1580976","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:10.115 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000091e-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"f8fabe6ad86e7460","TraceId":"b81205db5df4a726ec980947b1580976","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:10.153 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 85.3834 ms <PID: 277684, Thread: 10> {"SpanId":"f8fabe6ad86e7460","TraceId":"b81205db5df4a726ec980947b1580976","ParentId":"0000000000000000","RequestId":"8000091e-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:52.457 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 185> {"SpanId":"90b32a25f99c10e5","TraceId":"9f68f5466da4d079c26b8947659d5a0f","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000666-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:47:52.751 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625751 responded 500 in 1489.7916 ms <PID: 277684, Thread: 185> {"SpanId":"90b32a25f99c10e5","TraceId":"9f68f5466da4d079c26b8947659d5a0f","ParentId":"0000000000000000","RequestId":"80000666-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:47:52.765 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 185> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000666-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"90b32a25f99c10e5","TraceId":"9f68f5466da4d079c26b8947659d5a0f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:47:52.773 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 185> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000666-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"90b32a25f99c10e5","TraceId":"9f68f5466da4d079c26b8947659d5a0f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:47:53.196 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000666-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 185> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000666-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"90b32a25f99c10e5","TraceId":"9f68f5466da4d079c26b8947659d5a0f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:48:09.005 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000000e-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"3b9366f4bef571b0","TraceId":"deb66ec8b5fbf270104ec8fb60bafc4c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:09.006 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 10> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000000e-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"3b9366f4bef571b0","TraceId":"deb66ec8b5fbf270104ec8fb60bafc4c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:09.006 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 10> {"SpanId":"3b9366f4bef571b0","TraceId":"deb66ec8b5fbf270104ec8fb60bafc4c","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000000e-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:09.669 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 10> {"SpanId":"3b9366f4bef571b0","TraceId":"deb66ec8b5fbf270104ec8fb60bafc4c","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000000e-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:48:09.827 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 856.4578 ms <PID: 277684, Thread: 141> {"SpanId":"3b9366f4bef571b0","TraceId":"deb66ec8b5fbf270104ec8fb60bafc4c","ParentId":"0000000000000000","RequestId":"8000000e-0007-f200-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:09.883 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800002fa-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"692ceb5bc9266943","TraceId":"6d494829764edacd2b0a0f0ac1dddf77","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:09.884 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800002fa-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"692ceb5bc9266943","TraceId":"6d494829764edacd2b0a0f0ac1dddf77","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:09.912 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 62.3068 ms <PID: 277684, Thread: 10> {"SpanId":"692ceb5bc9266943","TraceId":"6d494829764edacd2b0a0f0ac1dddf77","ParentId":"0000000000000000","RequestId":"800002fa-0000-fa00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:52.450 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"53a9387b9a519538","TraceId":"58875bc25610cc06946261ec7fb957ca","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000472-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:48:52.786 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625753 responded 500 in 1547.8468 ms <PID: 277684, Thread: 7> {"SpanId":"53a9387b9a519538","TraceId":"58875bc25610cc06946261ec7fb957ca","ParentId":"0000000000000000","RequestId":"80000472-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:48:52.798 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000472-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"53a9387b9a519538","TraceId":"58875bc25610cc06946261ec7fb957ca","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:48:52.810 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000472-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"53a9387b9a519538","TraceId":"58875bc25610cc06946261ec7fb957ca","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:48:53.278 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000472-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000472-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"53a9387b9a519538","TraceId":"58875bc25610cc06946261ec7fb957ca","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:49:09.060 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 221> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000920-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"6fb7ce2cfa8a866c","TraceId":"25723c782a400c4c0f900dfd0c30ff53","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:09.061 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 221> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000920-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"6fb7ce2cfa8a866c","TraceId":"25723c782a400c4c0f900dfd0c30ff53","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:09.062 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 221> {"SpanId":"6fb7ce2cfa8a866c","TraceId":"25723c782a400c4c0f900dfd0c30ff53","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000920-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:09.706 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 221> {"SpanId":"6fb7ce2cfa8a866c","TraceId":"25723c782a400c4c0f900dfd0c30ff53","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000920-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:49:09.863 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 871.2703 ms <PID: 277684, Thread: 181> {"SpanId":"6fb7ce2cfa8a866c","TraceId":"25723c782a400c4c0f900dfd0c30ff53","ParentId":"0000000000000000","RequestId":"80000920-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:09.901 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 221> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000120-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"7cb0ab5a5747bfe6","TraceId":"0f5a6e2056acbaa7112ef6f347965a8a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:09.901 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 221> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000120-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"7cb0ab5a5747bfe6","TraceId":"0f5a6e2056acbaa7112ef6f347965a8a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:09.928 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 56.0966 ms <PID: 277684, Thread: 181> {"SpanId":"7cb0ab5a5747bfe6","TraceId":"0f5a6e2056acbaa7112ef6f347965a8a","ParentId":"0000000000000000","RequestId":"80000120-0003-f800-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:52.414 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"9ca4cd381f5d0acb","TraceId":"3d63ea8854bdbbf325cb89c7dc1685fe","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000668-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:49:52.710 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625755 responded 500 in 1472.9754 ms <PID: 277684, Thread: 7> {"SpanId":"9ca4cd381f5d0acb","TraceId":"3d63ea8854bdbbf325cb89c7dc1685fe","ParentId":"0000000000000000","RequestId":"80000668-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:49:52.723 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000668-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"9ca4cd381f5d0acb","TraceId":"3d63ea8854bdbbf325cb89c7dc1685fe","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:49:52.733 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000668-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"9ca4cd381f5d0acb","TraceId":"3d63ea8854bdbbf325cb89c7dc1685fe","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:49:53.110 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000668-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000668-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"9ca4cd381f5d0acb","TraceId":"3d63ea8854bdbbf325cb89c7dc1685fe","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:50:09.013 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000004e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"49a92ff6c4518856","TraceId":"977f741392493f03d0b4db092e35f835","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:09.014 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000004e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"49a92ff6c4518856","TraceId":"977f741392493f03d0b4db092e35f835","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:09.014 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 128> {"SpanId":"49a92ff6c4518856","TraceId":"977f741392493f03d0b4db092e35f835","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000004e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:09.628 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 128> {"SpanId":"49a92ff6c4518856","TraceId":"977f741392493f03d0b4db092e35f835","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000004e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:50:09.792 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 824.4245 ms <PID: 277684, Thread: 82> {"SpanId":"49a92ff6c4518856","TraceId":"977f741392493f03d0b4db092e35f835","ParentId":"0000000000000000","RequestId":"8000004e-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:09.848 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000922-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"5f10ffca2a1913b5","TraceId":"4ca8fcbbe343f22122bca886dcedf62c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:09.849 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000922-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"5f10ffca2a1913b5","TraceId":"4ca8fcbbe343f22122bca886dcedf62c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:09.883 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 68.2075 ms <PID: 277684, Thread: 141> {"SpanId":"5f10ffca2a1913b5","TraceId":"4ca8fcbbe343f22122bca886dcedf62c","ParentId":"0000000000000000","RequestId":"80000922-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:52.409 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"ad3c033bab38251f","TraceId":"658317e5e60e2d7e05a0201c94b65193","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000474-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:50:52.664 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625757 responded 500 in 1429.7115 ms <PID: 277684, Thread: 7> {"SpanId":"ad3c033bab38251f","TraceId":"658317e5e60e2d7e05a0201c94b65193","ParentId":"0000000000000000","RequestId":"80000474-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:50:52.674 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000474-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ad3c033bab38251f","TraceId":"658317e5e60e2d7e05a0201c94b65193","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:50:52.681 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000474-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ad3c033bab38251f","TraceId":"658317e5e60e2d7e05a0201c94b65193","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:50:52.985 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000474-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000474-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ad3c033bab38251f","TraceId":"658317e5e60e2d7e05a0201c94b65193","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:51:09.048 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000139-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"4474023b094924b4","TraceId":"cb2b4aefd10b934570a7493f8b309787","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:09.049 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000139-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"4474023b094924b4","TraceId":"cb2b4aefd10b934570a7493f8b309787","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:09.050 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 128> {"SpanId":"4474023b094924b4","TraceId":"cb2b4aefd10b934570a7493f8b309787","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000139-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:09.672 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 128> {"SpanId":"4474023b094924b4","TraceId":"cb2b4aefd10b934570a7493f8b309787","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000139-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:51:09.817 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 819.0105 ms <PID: 277684, Thread: 278> {"SpanId":"4474023b094924b4","TraceId":"cb2b4aefd10b934570a7493f8b309787","ParentId":"0000000000000000","RequestId":"80000139-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:09.873 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 278> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000050-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"db1f75be1fb06219","TraceId":"37b4964f5b9518b2c5f42f7999c2d160","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:09.874 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 278> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000050-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"db1f75be1fb06219","TraceId":"37b4964f5b9518b2c5f42f7999c2d160","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:09.910 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 74.3699 ms <PID: 277684, Thread: 128> {"SpanId":"db1f75be1fb06219","TraceId":"37b4964f5b9518b2c5f42f7999c2d160","ParentId":"0000000000000000","RequestId":"80000050-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:52.477 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"d4cc6b606bb5a19c","TraceId":"6428553c6f72700e17d9079f67ba07a4","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000066a-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:51:52.791 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625759 responded 500 in 1553.3973 ms <PID: 277684, Thread: 7> {"SpanId":"d4cc6b606bb5a19c","TraceId":"6428553c6f72700e17d9079f67ba07a4","ParentId":"0000000000000000","RequestId":"8000066a-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:51:52.808 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000066a-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d4cc6b606bb5a19c","TraceId":"6428553c6f72700e17d9079f67ba07a4","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:51:52.818 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000066a-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d4cc6b606bb5a19c","TraceId":"6428553c6f72700e17d9079f67ba07a4","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:51:53.280 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "8000066a-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000066a-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d4cc6b606bb5a19c","TraceId":"6428553c6f72700e17d9079f67ba07a4","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:52:08.978 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000052-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"7081f5054ea378f5","TraceId":"b38962b5234c0ec433357639e008a09a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:08.979 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000052-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"7081f5054ea378f5","TraceId":"b38962b5234c0ec433357639e008a09a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:08.979 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 128> {"SpanId":"7081f5054ea378f5","TraceId":"b38962b5234c0ec433357639e008a09a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000052-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:09.658 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 128> {"SpanId":"7081f5054ea378f5","TraceId":"b38962b5234c0ec433357639e008a09a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000052-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:52:09.843 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 901.1922 ms <PID: 277684, Thread: 40> {"SpanId":"7081f5054ea378f5","TraceId":"b38962b5234c0ec433357639e008a09a","ParentId":"0000000000000000","RequestId":"80000052-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:09.904 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000122-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"082d3a842b0d7634","TraceId":"d7397cedfb13b75962e99cf2a1e8d5b9","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:09.905 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000122-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"082d3a842b0d7634","TraceId":"d7397cedfb13b75962e99cf2a1e8d5b9","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:09.938 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 70.1046 ms <PID: 277684, Thread: 63> {"SpanId":"082d3a842b0d7634","TraceId":"d7397cedfb13b75962e99cf2a1e8d5b9","ParentId":"0000000000000000","RequestId":"80000122-0003-f800-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:52.439 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 150> {"SpanId":"d2c21cc118f548a2","TraceId":"eaf16d55f28a6a12bba7bad02050da44","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000476-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:52:52.738 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625761 responded 500 in 1500.5967 ms <PID: 277684, Thread: 150> {"SpanId":"d2c21cc118f548a2","TraceId":"eaf16d55f28a6a12bba7bad02050da44","ParentId":"0000000000000000","RequestId":"80000476-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:52:52.754 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 150> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000476-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d2c21cc118f548a2","TraceId":"eaf16d55f28a6a12bba7bad02050da44","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:52:52.762 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 150> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000476-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d2c21cc118f548a2","TraceId":"eaf16d55f28a6a12bba7bad02050da44","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:52:53.153 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000476-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 150> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000476-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"d2c21cc118f548a2","TraceId":"eaf16d55f28a6a12bba7bad02050da44","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:53:09.007 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 40> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000924-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"99a1e5977a7de66a","TraceId":"b646e17ca94a696c2c3ee12c4225ffa7","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:09.008 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 40> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000924-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"99a1e5977a7de66a","TraceId":"b646e17ca94a696c2c3ee12c4225ffa7","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:09.009 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 40> {"SpanId":"99a1e5977a7de66a","TraceId":"b646e17ca94a696c2c3ee12c4225ffa7","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000924-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:09.690 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 40> {"SpanId":"99a1e5977a7de66a","TraceId":"b646e17ca94a696c2c3ee12c4225ffa7","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000924-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:53:09.894 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 930.5422 ms <PID: 277684, Thread: 47> {"SpanId":"99a1e5977a7de66a","TraceId":"b646e17ca94a696c2c3ee12c4225ffa7","ParentId":"0000000000000000","RequestId":"80000924-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:09.962 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 47> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000013b-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"0503dce4d7c89bfb","TraceId":"95781a0628a640823f8350060fa6fcae","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:09.963 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 47> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000013b-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"0503dce4d7c89bfb","TraceId":"95781a0628a640823f8350060fa6fcae","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:09.999 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 80.2556 ms <PID: 277684, Thread: 63> {"SpanId":"0503dce4d7c89bfb","TraceId":"95781a0628a640823f8350060fa6fcae","ParentId":"0000000000000000","RequestId":"8000013b-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:52.454 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"e7a1f03b9dbdf1a1","TraceId":"7c268ce0d2d8bc412a4cf11a9a278f48","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000477-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:53:52.763 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625763 responded 500 in 1528.6851 ms <PID: 277684, Thread: 7> {"SpanId":"e7a1f03b9dbdf1a1","TraceId":"7c268ce0d2d8bc412a4cf11a9a278f48","ParentId":"0000000000000000","RequestId":"80000477-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:53:52.780 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000477-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e7a1f03b9dbdf1a1","TraceId":"7c268ce0d2d8bc412a4cf11a9a278f48","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:53:52.790 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000477-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e7a1f03b9dbdf1a1","TraceId":"7c268ce0d2d8bc412a4cf11a9a278f48","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:53:53.194 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000477-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000477-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"e7a1f03b9dbdf1a1","TraceId":"7c268ce0d2d8bc412a4cf11a9a278f48","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:54:09.020 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000926-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"f345feba0613051d","TraceId":"57f1d7a664ce14417d3b819594fcc40f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:09.021 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000926-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"f345feba0613051d","TraceId":"57f1d7a664ce14417d3b819594fcc40f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:09.021 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 63> {"SpanId":"f345feba0613051d","TraceId":"57f1d7a664ce14417d3b819594fcc40f","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000926-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:09.672 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 63> {"SpanId":"f345feba0613051d","TraceId":"57f1d7a664ce14417d3b819594fcc40f","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000926-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:54:09.843 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 866.8544 ms <PID: 277684, Thread: 40> {"SpanId":"f345feba0613051d","TraceId":"57f1d7a664ce14417d3b819594fcc40f","ParentId":"0000000000000000","RequestId":"80000926-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:09.914 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 160> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000054-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9f7e8a238be10cd3","TraceId":"f58f9333de72a2afc5f367733f149716","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:09.915 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 160> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000054-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9f7e8a238be10cd3","TraceId":"f58f9333de72a2afc5f367733f149716","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:09.950 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 74.9799 ms <PID: 277684, Thread: 63> {"SpanId":"9f7e8a238be10cd3","TraceId":"f58f9333de72a2afc5f367733f149716","ParentId":"0000000000000000","RequestId":"80000054-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:52.432 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"b1f4f3977d0ce022","TraceId":"e8a9125fae3dfae3deb24227e678fc90","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000066d-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:54:52.698 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625765 responded 500 in 1461.4501 ms <PID: 277684, Thread: 7> {"SpanId":"b1f4f3977d0ce022","TraceId":"e8a9125fae3dfae3deb24227e678fc90","ParentId":"0000000000000000","RequestId":"8000066d-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:54:52.713 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000066d-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"b1f4f3977d0ce022","TraceId":"e8a9125fae3dfae3deb24227e678fc90","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:54:52.725 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000066d-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"b1f4f3977d0ce022","TraceId":"e8a9125fae3dfae3deb24227e678fc90","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:54:53.153 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "8000066d-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000066d-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"b1f4f3977d0ce022","TraceId":"e8a9125fae3dfae3deb24227e678fc90","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:55:09.018 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 43> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000056-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"5117243e88482629","TraceId":"320d585c8a9afb220f062c5fdaea729f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:09.018 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 43> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000056-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"5117243e88482629","TraceId":"320d585c8a9afb220f062c5fdaea729f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:09.019 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 43> {"SpanId":"5117243e88482629","TraceId":"320d585c8a9afb220f062c5fdaea729f","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000056-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:09.701 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 43> {"SpanId":"5117243e88482629","TraceId":"320d585c8a9afb220f062c5fdaea729f","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000056-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:55:09.876 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 895.7965 ms <PID: 277684, Thread: 63> {"SpanId":"5117243e88482629","TraceId":"320d585c8a9afb220f062c5fdaea729f","ParentId":"0000000000000000","RequestId":"80000056-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:09.929 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000058-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"67642cc8970f3faf","TraceId":"0de7fa4ebf506f5a04716273aad49966","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:09.930 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000058-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"67642cc8970f3faf","TraceId":"0de7fa4ebf506f5a04716273aad49966","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:09.954 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 49.7468 ms <PID: 277684, Thread: 43> {"SpanId":"67642cc8970f3faf","TraceId":"0de7fa4ebf506f5a04716273aad49966","ParentId":"0000000000000000","RequestId":"80000058-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:52.457 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"fc97b689710b5de3","TraceId":"b8095eb6a7071695302ab810215db878","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000479-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:55:52.739 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625767 responded 500 in 1507.4358 ms <PID: 277684, Thread: 7> {"SpanId":"fc97b689710b5de3","TraceId":"b8095eb6a7071695302ab810215db878","ParentId":"0000000000000000","RequestId":"80000479-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:55:52.752 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000479-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"fc97b689710b5de3","TraceId":"b8095eb6a7071695302ab810215db878","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:55:52.765 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000479-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"fc97b689710b5de3","TraceId":"b8095eb6a7071695302ab810215db878","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:55:53.207 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000479-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000479-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"fc97b689710b5de3","TraceId":"b8095eb6a7071695302ab810215db878","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:56:09.026 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 160> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000928-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"769636d327f58bab","TraceId":"870557c1f856bc24e723da131661230e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:09.027 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 160> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000928-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"769636d327f58bab","TraceId":"870557c1f856bc24e723da131661230e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:09.028 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 160> {"SpanId":"769636d327f58bab","TraceId":"870557c1f856bc24e723da131661230e","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000928-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:09.704 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 160> {"SpanId":"769636d327f58bab","TraceId":"870557c1f856bc24e723da131661230e","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000928-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:56:09.889 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 914.5322 ms <PID: 277684, Thread: 205> {"SpanId":"769636d327f58bab","TraceId":"870557c1f856bc24e723da131661230e","ParentId":"0000000000000000","RequestId":"80000928-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:09.933 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 205> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000013d-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"f4e4c1f24015f213","TraceId":"ffb9f2a4897b9612d8983c189d5757b0","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:09.933 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 205> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000013d-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"f4e4c1f24015f213","TraceId":"ffb9f2a4897b9612d8983c189d5757b0","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:09.963 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 55.4177 ms <PID: 277684, Thread: 160> {"SpanId":"f4e4c1f24015f213","TraceId":"ffb9f2a4897b9612d8983c189d5757b0","ParentId":"0000000000000000","RequestId":"8000013d-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:52.440 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"20e7a29374cc9b73","TraceId":"231b9f95d3039d40a293d5115ddb2751","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000066f-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:56:52.664 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625769 responded 500 in 1428.8516 ms <PID: 277684, Thread: 7> {"SpanId":"20e7a29374cc9b73","TraceId":"231b9f95d3039d40a293d5115ddb2751","ParentId":"0000000000000000","RequestId":"8000066f-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:56:52.675 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000066f-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"20e7a29374cc9b73","TraceId":"231b9f95d3039d40a293d5115ddb2751","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:56:52.681 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000066f-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"20e7a29374cc9b73","TraceId":"231b9f95d3039d40a293d5115ddb2751","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:56:52.997 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "8000066f-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000066f-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"20e7a29374cc9b73","TraceId":"231b9f95d3039d40a293d5115ddb2751","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:57:08.991 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000124-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"d3d6c83dc74a183b","TraceId":"222330e4eac3cac79c87839f3f5e75a9","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:08.992 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000124-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"d3d6c83dc74a183b","TraceId":"222330e4eac3cac79c87839f3f5e75a9","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:08.993 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 77> {"SpanId":"d3d6c83dc74a183b","TraceId":"222330e4eac3cac79c87839f3f5e75a9","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000124-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:09.586 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 77> {"SpanId":"d3d6c83dc74a183b","TraceId":"222330e4eac3cac79c87839f3f5e75a9","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000124-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:57:09.728 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 772.3062 ms <PID: 277684, Thread: 205> {"SpanId":"d3d6c83dc74a183b","TraceId":"222330e4eac3cac79c87839f3f5e75a9","ParentId":"0000000000000000","RequestId":"80000124-0003-f800-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:09.776 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000010-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"c6abb0997ab27942","TraceId":"896da8c8ff691117dd1e439df95c7ecd","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:09.776 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000010-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"c6abb0997ab27942","TraceId":"896da8c8ff691117dd1e439df95c7ecd","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:09.804 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 55.5027 ms <PID: 277684, Thread: 160> {"SpanId":"c6abb0997ab27942","TraceId":"896da8c8ff691117dd1e439df95c7ecd","ParentId":"0000000000000000","RequestId":"80000010-0007-f200-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:52.418 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"4d800426bce4f79f","TraceId":"5fc16806ff3de716e4d3c5a24db09818","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000047b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:57:52.641 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625771 responded 500 in 1407.6467 ms <PID: 277684, Thread: 7> {"SpanId":"4d800426bce4f79f","TraceId":"5fc16806ff3de716e4d3c5a24db09818","ParentId":"0000000000000000","RequestId":"8000047b-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:57:52.653 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000047b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4d800426bce4f79f","TraceId":"5fc16806ff3de716e4d3c5a24db09818","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:57:52.661 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000047b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4d800426bce4f79f","TraceId":"5fc16806ff3de716e4d3c5a24db09818","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:57:53.017 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "8000047b-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000047b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4d800426bce4f79f","TraceId":"5fc16806ff3de716e4d3c5a24db09818","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:58:08.993 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 43> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000012-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"302f1dad5f1a24d6","TraceId":"7eb301c74610496603ae9bd4bb26e045","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:08.994 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 43> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000012-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"302f1dad5f1a24d6","TraceId":"7eb301c74610496603ae9bd4bb26e045","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:08.995 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 43> {"SpanId":"302f1dad5f1a24d6","TraceId":"7eb301c74610496603ae9bd4bb26e045","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000012-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:09.678 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 43> {"SpanId":"302f1dad5f1a24d6","TraceId":"7eb301c74610496603ae9bd4bb26e045","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000012-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:58:09.867 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 909.5298 ms <PID: 277684, Thread: 141> {"SpanId":"302f1dad5f1a24d6","TraceId":"7eb301c74610496603ae9bd4bb26e045","ParentId":"0000000000000000","RequestId":"80000012-0007-f200-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:09.924 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000037e-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"15e2cb3d4c887343","TraceId":"abdf05bdfa7a0acd534c84d0f3837a27","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:09.925 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 141> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000037e-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"15e2cb3d4c887343","TraceId":"abdf05bdfa7a0acd534c84d0f3837a27","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:09.961 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 69.7203 ms <PID: 277684, Thread: 181> {"SpanId":"15e2cb3d4c887343","TraceId":"abdf05bdfa7a0acd534c84d0f3837a27","ParentId":"0000000000000000","RequestId":"8000037e-0006-f700-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:52.427 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"87980190390e1b66","TraceId":"6a1b4856cc1f369f02d55bf37bb2c40f","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000671-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:58:52.710 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625773 responded 500 in 1477.0692 ms <PID: 277684, Thread: 7> {"SpanId":"87980190390e1b66","TraceId":"6a1b4856cc1f369f02d55bf37bb2c40f","ParentId":"0000000000000000","RequestId":"80000671-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:58:52.728 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000671-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"87980190390e1b66","TraceId":"6a1b4856cc1f369f02d55bf37bb2c40f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:58:52.738 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000671-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"87980190390e1b66","TraceId":"6a1b4856cc1f369f02d55bf37bb2c40f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:58:53.144 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000671-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000671-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"87980190390e1b66","TraceId":"6a1b4856cc1f369f02d55bf37bb2c40f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 15:59:09.007 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 165> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000092a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"8aa5c8b2502880c4","TraceId":"06431b54609bc391eb3e1ed3d6287940","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:09.008 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 165> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000092a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"8aa5c8b2502880c4","TraceId":"06431b54609bc391eb3e1ed3d6287940","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:09.009 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 165> {"SpanId":"8aa5c8b2502880c4","TraceId":"06431b54609bc391eb3e1ed3d6287940","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000092a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:09.699 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 165> {"SpanId":"8aa5c8b2502880c4","TraceId":"06431b54609bc391eb3e1ed3d6287940","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000092a-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 15:59:09.876 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 909.5126 ms <PID: 277684, Thread: 43> {"SpanId":"8aa5c8b2502880c4","TraceId":"06431b54609bc391eb3e1ed3d6287940","ParentId":"0000000000000000","RequestId":"8000092a-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:09.938 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 43> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000005a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"31073c894b17f197","TraceId":"c920a097bf4bf4b30d9610d8f519fb19","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:09.939 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 43> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000005a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"31073c894b17f197","TraceId":"c920a097bf4bf4b30d9610d8f519fb19","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:09.973 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 73.3080 ms <PID: 277684, Thread: 221> {"SpanId":"31073c894b17f197","TraceId":"c920a097bf4bf4b30d9610d8f519fb19","ParentId":"0000000000000000","RequestId":"8000005a-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:52.447 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 185> {"SpanId":"4ad94991395a6135","TraceId":"86e4c7871b80e38fa70c6d7ed0d602c9","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000672-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 15:59:52.761 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625775 responded 500 in 1528.5550 ms <PID: 277684, Thread: 185> {"SpanId":"4ad94991395a6135","TraceId":"86e4c7871b80e38fa70c6d7ed0d602c9","ParentId":"0000000000000000","RequestId":"80000672-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 15:59:52.775 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 185> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000672-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4ad94991395a6135","TraceId":"86e4c7871b80e38fa70c6d7ed0d602c9","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 15:59:52.784 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 185> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000672-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4ad94991395a6135","TraceId":"86e4c7871b80e38fa70c6d7ed0d602c9","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 15:59:53.122 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000672-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 185> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000672-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"4ad94991395a6135","TraceId":"86e4c7871b80e38fa70c6d7ed0d602c9","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:00:08.925 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 180> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000092c-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"26c4ebf0bc2d67e5","TraceId":"328081b13220fce81397f2be2b561de1","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:08.925 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 180> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000092c-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"26c4ebf0bc2d67e5","TraceId":"328081b13220fce81397f2be2b561de1","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:08.926 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 180> {"SpanId":"26c4ebf0bc2d67e5","TraceId":"328081b13220fce81397f2be2b561de1","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000092c-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:09.336 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 180> {"SpanId":"26c4ebf0bc2d67e5","TraceId":"328081b13220fce81397f2be2b561de1","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000092c-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:00:09.420 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 522.4202 ms <PID: 277684, Thread: 159> {"SpanId":"26c4ebf0bc2d67e5","TraceId":"328081b13220fce81397f2be2b561de1","ParentId":"0000000000000000","RequestId":"8000092c-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:09.454 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 159> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000005c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"3bc525b0c47469dc","TraceId":"42cc00efc6abe02598400789e4c42aff","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:09.454 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 159> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000005c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"3bc525b0c47469dc","TraceId":"42cc00efc6abe02598400789e4c42aff","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:09.473 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 40.2621 ms <PID: 277684, Thread: 47> {"SpanId":"3bc525b0c47469dc","TraceId":"42cc00efc6abe02598400789e4c42aff","ParentId":"0000000000000000","RequestId":"8000005c-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:52.401 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"99c165dcbefb00f0","TraceId":"207ac5557f77f249c342d8c2c5888f98","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000673-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:00:52.635 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625777 responded 500 in 1403.3437 ms <PID: 277684, Thread: 7> {"SpanId":"99c165dcbefb00f0","TraceId":"207ac5557f77f249c342d8c2c5888f98","ParentId":"0000000000000000","RequestId":"80000673-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:00:52.645 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000673-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"99c165dcbefb00f0","TraceId":"207ac5557f77f249c342d8c2c5888f98","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:00:52.653 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000673-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"99c165dcbefb00f0","TraceId":"207ac5557f77f249c342d8c2c5888f98","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:00:53.114 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000673-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000673-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"99c165dcbefb00f0","TraceId":"207ac5557f77f249c342d8c2c5888f98","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:01:09.365 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 208> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000005e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"e62ba9f672c2d5ce","TraceId":"ce875eef710d5fb0e7bad08274fdeff7","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:09.366 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 208> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000005e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"e62ba9f672c2d5ce","TraceId":"ce875eef710d5fb0e7bad08274fdeff7","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:09.367 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 208> {"SpanId":"e62ba9f672c2d5ce","TraceId":"ce875eef710d5fb0e7bad08274fdeff7","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000005e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:09.876 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 208> {"SpanId":"e62ba9f672c2d5ce","TraceId":"ce875eef710d5fb0e7bad08274fdeff7","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000005e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:01:09.970 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 631.9399 ms <PID: 277684, Thread: 159> {"SpanId":"e62ba9f672c2d5ce","TraceId":"ce875eef710d5fb0e7bad08274fdeff7","ParentId":"0000000000000000","RequestId":"8000005e-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:10.008 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 159> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000126-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"94439817c902302a","TraceId":"89b704b7ea378782b03d4dfa6ba59647","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:10.008 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 159> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000126-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"94439817c902302a","TraceId":"89b704b7ea378782b03d4dfa6ba59647","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:10.028 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 42.9989 ms <PID: 277684, Thread: 160> {"SpanId":"94439817c902302a","TraceId":"89b704b7ea378782b03d4dfa6ba59647","ParentId":"0000000000000000","RequestId":"80000126-0003-f800-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:52.463 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 63> {"SpanId":"c9ce80f1f0c93700","TraceId":"ba4416e87441b6cecb36fd1c781fe58f","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800000d2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:01:52.780 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625779 responded 500 in 1548.4665 ms <PID: 277684, Thread: 63> {"SpanId":"c9ce80f1f0c93700","TraceId":"ba4416e87441b6cecb36fd1c781fe58f","ParentId":"0000000000000000","RequestId":"800000d2-0007-f900-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:01:52.793 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800000d2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"c9ce80f1f0c93700","TraceId":"ba4416e87441b6cecb36fd1c781fe58f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:01:52.801 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800000d2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"c9ce80f1f0c93700","TraceId":"ba4416e87441b6cecb36fd1c781fe58f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:01:53.225 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17942340947119440067", Request ID "800000d2-0007-f900-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800000d2-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"c9ce80f1f0c93700","TraceId":"ba4416e87441b6cecb36fd1c781fe58f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:02:08.981 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 150> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000013f-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"17b3e305e0edb39b","TraceId":"eec80dc4bf6cf9ed557b289d7826d31b","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:08.982 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 150> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000013f-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"17b3e305e0edb39b","TraceId":"eec80dc4bf6cf9ed557b289d7826d31b","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:08.982 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 150> {"SpanId":"17b3e305e0edb39b","TraceId":"eec80dc4bf6cf9ed557b289d7826d31b","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000013f-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:09.515 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 150> {"SpanId":"17b3e305e0edb39b","TraceId":"eec80dc4bf6cf9ed557b289d7826d31b","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000013f-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:02:09.662 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 715.5376 ms <PID: 277684, Thread: 180> {"SpanId":"17b3e305e0edb39b","TraceId":"eec80dc4bf6cf9ed557b289d7826d31b","ParentId":"0000000000000000","RequestId":"8000013f-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:09.707 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 97> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800000b0-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9ed7ae270cb00e64","TraceId":"41e6ab9861b3f44dd73d8cdee016499e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:09.707 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 97> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800000b0-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"9ed7ae270cb00e64","TraceId":"41e6ab9861b3f44dd73d8cdee016499e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:09.729 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 51.9489 ms <PID: 277684, Thread: 122> {"SpanId":"9ed7ae270cb00e64","TraceId":"41e6ab9861b3f44dd73d8cdee016499e","ParentId":"0000000000000000","RequestId":"800000b0-0005-fc00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:15.728 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/ems/license responded 200 in 3.7850 ms <PID: 277684, Thread: 77> {"SpanId":"d66fdfba0bfc3622","TraceId":"30cfc1a2ec294849d7e33aa7b2725abf","ParentId":"0000000000000000","RequestId":"80000014-0007-f200-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:52.453 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 63> {"SpanId":"ed2746eeff277d44","TraceId":"d54091a1a198d943dc9d49ceeb23e4ee","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000675-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:02:52.765 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625781 responded 500 in 1532.1567 ms <PID: 277684, Thread: 63> {"SpanId":"ed2746eeff277d44","TraceId":"d54091a1a198d943dc9d49ceeb23e4ee","ParentId":"0000000000000000","RequestId":"80000675-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:02:52.777 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000675-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ed2746eeff277d44","TraceId":"d54091a1a198d943dc9d49ceeb23e4ee","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:02:52.791 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000675-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ed2746eeff277d44","TraceId":"d54091a1a198d943dc9d49ceeb23e4ee","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:02:53.200 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000675-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000675-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"ed2746eeff277d44","TraceId":"d54091a1a198d943dc9d49ceeb23e4ee","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:03:09.007 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 97> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"800000b2-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"d2deff38cf2ced26","TraceId":"89da46cb718e492008543cf97ab2c3d8","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:09.008 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 97> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"800000b2-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"d2deff38cf2ced26","TraceId":"89da46cb718e492008543cf97ab2c3d8","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:09.008 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 97> {"SpanId":"d2deff38cf2ced26","TraceId":"89da46cb718e492008543cf97ab2c3d8","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"800000b2-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:09.619 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 97> {"SpanId":"d2deff38cf2ced26","TraceId":"89da46cb718e492008543cf97ab2c3d8","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"800000b2-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:03:09.750 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 776.3543 ms <PID: 277684, Thread: 150> {"SpanId":"d2deff38cf2ced26","TraceId":"89da46cb718e492008543cf97ab2c3d8","ParentId":"0000000000000000","RequestId":"800000b2-0005-fc00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:09.806 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 48> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000141-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"a20b0b4181a3c006","TraceId":"724d6e84a55cfad9f590ed357478834e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:09.807 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 48> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000141-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"a20b0b4181a3c006","TraceId":"724d6e84a55cfad9f590ed357478834e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:09.830 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 59.4283 ms <PID: 277684, Thread: 77> {"SpanId":"a20b0b4181a3c006","TraceId":"724d6e84a55cfad9f590ed357478834e","ParentId":"0000000000000000","RequestId":"80000141-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:52.378 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"555e3055f921f91b","TraceId":"26e02b8de89dfe81e400e3560ecfccee","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000676-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:03:52.549 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625783 responded 500 in 1318.9652 ms <PID: 277684, Thread: 7> {"SpanId":"555e3055f921f91b","TraceId":"26e02b8de89dfe81e400e3560ecfccee","ParentId":"0000000000000000","RequestId":"80000676-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:03:52.559 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000676-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"555e3055f921f91b","TraceId":"26e02b8de89dfe81e400e3560ecfccee","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:03:52.566 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000676-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"555e3055f921f91b","TraceId":"26e02b8de89dfe81e400e3560ecfccee","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:03:52.831 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000676-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000676-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"555e3055f921f91b","TraceId":"26e02b8de89dfe81e400e3560ecfccee","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:04:08.920 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 157> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"800002fc-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"c1eb1bb0fb55c2d0","TraceId":"17674087ca5f292c24b1db07492c02da","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:08.920 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 157> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"800002fc-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"c1eb1bb0fb55c2d0","TraceId":"17674087ca5f292c24b1db07492c02da","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:08.921 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 157> {"SpanId":"c1eb1bb0fb55c2d0","TraceId":"17674087ca5f292c24b1db07492c02da","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"800002fc-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:09.344 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 157> {"SpanId":"c1eb1bb0fb55c2d0","TraceId":"17674087ca5f292c24b1db07492c02da","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"800002fc-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:04:09.544 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 651.8388 ms <PID: 277684, Thread: 150> {"SpanId":"c1eb1bb0fb55c2d0","TraceId":"17674087ca5f292c24b1db07492c02da","ParentId":"0000000000000000","RequestId":"800002fc-0000-fa00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:09.576 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 150> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800002fe-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"fff887228083c5e0","TraceId":"07b9c666d3446ca8ee9fbb70b608f1b7","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:09.576 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 150> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800002fe-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"fff887228083c5e0","TraceId":"07b9c666d3446ca8ee9fbb70b608f1b7","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:09.591 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 33.7377 ms <PID: 277684, Thread: 225> {"SpanId":"fff887228083c5e0","TraceId":"07b9c666d3446ca8ee9fbb70b608f1b7","ParentId":"0000000000000000","RequestId":"800002fe-0000-fa00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:52.498 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"3b1fb5b4834dd3f6","TraceId":"f970b2c4506cc4f4aab04170bc9f579b","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000677-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:04:52.794 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625785 responded 500 in 1558.5842 ms <PID: 277684, Thread: 7> {"SpanId":"3b1fb5b4834dd3f6","TraceId":"f970b2c4506cc4f4aab04170bc9f579b","ParentId":"0000000000000000","RequestId":"80000677-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:04:52.805 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000677-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3b1fb5b4834dd3f6","TraceId":"f970b2c4506cc4f4aab04170bc9f579b","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:04:52.813 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000677-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3b1fb5b4834dd3f6","TraceId":"f970b2c4506cc4f4aab04170bc9f579b","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:04:53.139 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000677-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000677-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3b1fb5b4834dd3f6","TraceId":"f970b2c4506cc4f4aab04170bc9f579b","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:05:08.924 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000012a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"c4611dc6adbb49e7","TraceId":"4b9fa02fcf83c2e80587d19028fcd211","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:08.925 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000012a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"c4611dc6adbb49e7","TraceId":"4b9fa02fcf83c2e80587d19028fcd211","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:08.925 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 77> {"SpanId":"c4611dc6adbb49e7","TraceId":"4b9fa02fcf83c2e80587d19028fcd211","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000012a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:09.362 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 77> {"SpanId":"c4611dc6adbb49e7","TraceId":"4b9fa02fcf83c2e80587d19028fcd211","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000012a-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:05:09.481 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 585.8641 ms <PID: 277684, Thread: 225> {"SpanId":"c4611dc6adbb49e7","TraceId":"4b9fa02fcf83c2e80587d19028fcd211","ParentId":"0000000000000000","RequestId":"8000012a-0003-f800-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:09.514 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 225> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000012c-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"87b99ea3f28990e4","TraceId":"edacb8caffd66b3b5094f9b4300d9054","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:09.514 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 225> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000012c-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"87b99ea3f28990e4","TraceId":"edacb8caffd66b3b5094f9b4300d9054","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:09.543 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 48.3678 ms <PID: 277684, Thread: 150> {"SpanId":"87b99ea3f28990e4","TraceId":"edacb8caffd66b3b5094f9b4300d9054","ParentId":"0000000000000000","RequestId":"8000012c-0003-f800-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:52.442 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 63> {"SpanId":"9c45d56ca19c2d59","TraceId":"19d8b03bd930a7f4e858e06b62884afa","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000483-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:05:52.751 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625787 responded 500 in 1505.9675 ms <PID: 277684, Thread: 63> {"SpanId":"9c45d56ca19c2d59","TraceId":"19d8b03bd930a7f4e858e06b62884afa","ParentId":"0000000000000000","RequestId":"80000483-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:05:52.765 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000483-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"9c45d56ca19c2d59","TraceId":"19d8b03bd930a7f4e858e06b62884afa","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:05:52.774 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000483-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"9c45d56ca19c2d59","TraceId":"19d8b03bd930a7f4e858e06b62884afa","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:05:53.219 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000483-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000483-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"9c45d56ca19c2d59","TraceId":"19d8b03bd930a7f4e858e06b62884afa","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:06:08.976 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 5> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000300-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"f9e1a4992c8fd783","TraceId":"43962394c7500b1f871d97f3cdc1e989","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:08.977 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 5> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000300-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"f9e1a4992c8fd783","TraceId":"43962394c7500b1f871d97f3cdc1e989","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:08.977 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 5> {"SpanId":"f9e1a4992c8fd783","TraceId":"43962394c7500b1f871d97f3cdc1e989","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000300-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:09.552 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 5> {"SpanId":"f9e1a4992c8fd783","TraceId":"43962394c7500b1f871d97f3cdc1e989","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000300-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:06:09.670 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 725.3983 ms <PID: 277684, Thread: 13> {"SpanId":"f9e1a4992c8fd783","TraceId":"43962394c7500b1f871d97f3cdc1e989","ParentId":"0000000000000000","RequestId":"80000300-0000-fa00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:09.716 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 152> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000060-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"6b26d1f07ff97c38","TraceId":"259704eb3ea95e0aae149074ba2740bc","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:09.717 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 152> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000060-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"6b26d1f07ff97c38","TraceId":"259704eb3ea95e0aae149074ba2740bc","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:09.732 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 38.2580 ms <PID: 277684, Thread: 5> {"SpanId":"6b26d1f07ff97c38","TraceId":"259704eb3ea95e0aae149074ba2740bc","ParentId":"0000000000000000","RequestId":"80000060-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:52.427 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 63> {"SpanId":"0933ab07b2a68eb3","TraceId":"196af058545051084270ea8006216620","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000679-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:06:52.713 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625789 responded 500 in 1482.3088 ms <PID: 277684, Thread: 63> {"SpanId":"0933ab07b2a68eb3","TraceId":"196af058545051084270ea8006216620","ParentId":"0000000000000000","RequestId":"80000679-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:06:52.728 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 63> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000679-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"0933ab07b2a68eb3","TraceId":"196af058545051084270ea8006216620","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:06:52.738 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000679-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"0933ab07b2a68eb3","TraceId":"196af058545051084270ea8006216620","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:06:53.101 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "80000679-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 63> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000679-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"0933ab07b2a68eb3","TraceId":"196af058545051084270ea8006216620","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:07:09.028 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000062-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"001e089759681e64","TraceId":"f44016b04bc30ab83be43a0d045daa60","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:09.029 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000062-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"001e089759681e64","TraceId":"f44016b04bc30ab83be43a0d045daa60","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:09.030 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 77> {"SpanId":"001e089759681e64","TraceId":"f44016b04bc30ab83be43a0d045daa60","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000062-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:09.677 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 77> {"SpanId":"001e089759681e64","TraceId":"f44016b04bc30ab83be43a0d045daa60","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000062-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:07:09.839 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 862.8902 ms <PID: 277684, Thread: 13> {"SpanId":"001e089759681e64","TraceId":"f44016b04bc30ab83be43a0d045daa60","ParentId":"0000000000000000","RequestId":"80000062-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:09.893 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000016-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"fc3c3c8453e9e5d2","TraceId":"ac9d123f9103a6ce6c372536bce82626","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:09.894 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000016-0007-f200-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"fc3c3c8453e9e5d2","TraceId":"ac9d123f9103a6ce6c372536bce82626","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:09.926 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 65.2840 ms <PID: 277684, Thread: 150> {"SpanId":"fc3c3c8453e9e5d2","TraceId":"ac9d123f9103a6ce6c372536bce82626","ParentId":"0000000000000000","RequestId":"80000016-0007-f200-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:52.351 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 70> {"SpanId":"561e358a89300228","TraceId":"2049caff59ca641933795481f91b9cf1","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000485-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:07:52.528 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625791 responded 500 in 1297.6063 ms <PID: 277684, Thread: 70> {"SpanId":"561e358a89300228","TraceId":"2049caff59ca641933795481f91b9cf1","ParentId":"0000000000000000","RequestId":"80000485-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:07:52.537 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 70> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000485-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"561e358a89300228","TraceId":"2049caff59ca641933795481f91b9cf1","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:07:52.542 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000485-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"561e358a89300228","TraceId":"2049caff59ca641933795481f91b9cf1","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:07:52.790 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000485-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000485-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"561e358a89300228","TraceId":"2049caff59ca641933795481f91b9cf1","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:08:09.272 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000012e-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"4f865ec8e6722cd3","TraceId":"37c353b58a8652f0cfecc4f64a01ca8f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:09.273 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000012e-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"4f865ec8e6722cd3","TraceId":"37c353b58a8652f0cfecc4f64a01ca8f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:09.274 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 13> {"SpanId":"4f865ec8e6722cd3","TraceId":"37c353b58a8652f0cfecc4f64a01ca8f","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000012e-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:09.755 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 13> {"SpanId":"4f865ec8e6722cd3","TraceId":"37c353b58a8652f0cfecc4f64a01ca8f","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000012e-0003-f800-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:08:09.856 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 621.6211 ms <PID: 277684, Thread: 188> {"SpanId":"4f865ec8e6722cd3","TraceId":"37c353b58a8652f0cfecc4f64a01ca8f","ParentId":"0000000000000000","RequestId":"8000012e-0003-f800-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:09.905 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 188> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000064-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"defcc87efd98ea48","TraceId":"dfcac490283091fca6fcb234ea49161e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:09.906 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 188> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000064-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"defcc87efd98ea48","TraceId":"dfcac490283091fca6fcb234ea49161e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:09.932 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 50.8787 ms <PID: 277684, Thread: 229> {"SpanId":"defcc87efd98ea48","TraceId":"dfcac490283091fca6fcb234ea49161e","ParentId":"0000000000000000","RequestId":"80000064-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:52.429 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 70> {"SpanId":"1a870e57770b182d","TraceId":"dfb7283c0a22b251f12c215ef697fd8f","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000067b-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:08:52.708 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625793 responded 500 in 1472.3654 ms <PID: 277684, Thread: 70> {"SpanId":"1a870e57770b182d","TraceId":"dfb7283c0a22b251f12c215ef697fd8f","ParentId":"0000000000000000","RequestId":"8000067b-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:08:52.723 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 70> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000067b-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"1a870e57770b182d","TraceId":"dfb7283c0a22b251f12c215ef697fd8f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:08:52.733 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000067b-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"1a870e57770b182d","TraceId":"dfb7283c0a22b251f12c215ef697fd8f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:08:53.084 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "18086456126605362789", Request ID "8000067b-0005-fb00-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000067b-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"1a870e57770b182d","TraceId":"dfb7283c0a22b251f12c215ef697fd8f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:09:09.029 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000066-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"a09d225527be724b","TraceId":"d27d9adf78fbaa09da7ab641ce345f5a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:09.031 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000066-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"a09d225527be724b","TraceId":"d27d9adf78fbaa09da7ab641ce345f5a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:09.031 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 77> {"SpanId":"a09d225527be724b","TraceId":"d27d9adf78fbaa09da7ab641ce345f5a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000066-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:09.708 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 77> {"SpanId":"a09d225527be724b","TraceId":"d27d9adf78fbaa09da7ab641ce345f5a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000066-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:09:09.885 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 903.3484 ms <PID: 277684, Thread: 53> {"SpanId":"a09d225527be724b","TraceId":"d27d9adf78fbaa09da7ab641ce345f5a","ParentId":"0000000000000000","RequestId":"80000066-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:09.960 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 53> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000092e-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"54a3a7267ccc358a","TraceId":"f1a7f551d08d66e3f83100daf7d40689","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:09.961 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 53> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000092e-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"54a3a7267ccc358a","TraceId":"f1a7f551d08d66e3f83100daf7d40689","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:09.998 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 79.5270 ms <PID: 277684, Thread: 13> {"SpanId":"54a3a7267ccc358a","TraceId":"f1a7f551d08d66e3f83100daf7d40689","ParentId":"0000000000000000","RequestId":"8000092e-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:52.442 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"1d1bf533a674d415","TraceId":"eca864a7f6e2f921d5ae0c81a6c62b50","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000487-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:09:52.741 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625795 responded 500 in 1511.5338 ms <PID: 277684, Thread: 7> {"SpanId":"1d1bf533a674d415","TraceId":"eca864a7f6e2f921d5ae0c81a6c62b50","ParentId":"0000000000000000","RequestId":"80000487-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:09:52.754 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000487-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"1d1bf533a674d415","TraceId":"eca864a7f6e2f921d5ae0c81a6c62b50","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:09:52.762 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000487-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"1d1bf533a674d415","TraceId":"eca864a7f6e2f921d5ae0c81a6c62b50","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:09:53.193 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000487-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000487-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"1d1bf533a674d415","TraceId":"eca864a7f6e2f921d5ae0c81a6c62b50","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:10:08.963 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 83> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000380-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"fda196a7cd7afc13","TraceId":"b98d19efb95af02f358edf739b61c650","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:08.964 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 83> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000380-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"fda196a7cd7afc13","TraceId":"b98d19efb95af02f358edf739b61c650","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:08.964 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 83> {"SpanId":"fda196a7cd7afc13","TraceId":"b98d19efb95af02f358edf739b61c650","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000380-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:09.497 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 83> {"SpanId":"fda196a7cd7afc13","TraceId":"b98d19efb95af02f358edf739b61c650","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000380-0006-f700-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:10:09.644 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 705.6166 ms <PID: 277684, Thread: 13> {"SpanId":"fda196a7cd7afc13","TraceId":"b98d19efb95af02f358edf739b61c650","ParentId":"0000000000000000","RequestId":"80000380-0006-f700-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:09.685 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000068-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"162519bf4272db6a","TraceId":"d5e5c9153a3c688bb0923d873f3b2dd3","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:09.685 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000068-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"162519bf4272db6a","TraceId":"d5e5c9153a3c688bb0923d873f3b2dd3","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:09.710 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 49.1462 ms <PID: 277684, Thread: 53> {"SpanId":"162519bf4272db6a","TraceId":"d5e5c9153a3c688bb0923d873f3b2dd3","ParentId":"0000000000000000","RequestId":"80000068-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:52.409 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 70> {"SpanId":"3df952d9f1fe1bb3","TraceId":"3df4c70573432b7dd34676f6a3633747","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000488-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:10:52.710 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625797 responded 500 in 1480.2950 ms <PID: 277684, Thread: 70> {"SpanId":"3df952d9f1fe1bb3","TraceId":"3df4c70573432b7dd34676f6a3633747","ParentId":"0000000000000000","RequestId":"80000488-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:10:52.725 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 70> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000488-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3df952d9f1fe1bb3","TraceId":"3df4c70573432b7dd34676f6a3633747","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:10:52.736 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"80000488-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3df952d9f1fe1bb3","TraceId":"3df4c70573432b7dd34676f6a3633747","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:10:53.089 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "80000488-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"80000488-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3df952d9f1fe1bb3","TraceId":"3df4c70573432b7dd34676f6a3633747","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:11:09.016 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000930-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"a6832bdaa789d965","TraceId":"8625ec6e8f5da169330d64c2c9275b2a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:09.017 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 13> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000930-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"a6832bdaa789d965","TraceId":"8625ec6e8f5da169330d64c2c9275b2a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:09.017 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 13> {"SpanId":"a6832bdaa789d965","TraceId":"8625ec6e8f5da169330d64c2c9275b2a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000930-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:09.689 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 13> {"SpanId":"a6832bdaa789d965","TraceId":"8625ec6e8f5da169330d64c2c9275b2a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000930-0001-fd00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:11:09.846 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 862.0482 ms <PID: 277684, Thread: 77> {"SpanId":"a6832bdaa789d965","TraceId":"8625ec6e8f5da169330d64c2c9275b2a","ParentId":"0000000000000000","RequestId":"80000930-0001-fd00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:09.905 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000143-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"1e29c75766b0f0f3","TraceId":"1ca6478d95e55337d0e8cf3cf6e46e60","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:09.906 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 77> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"80000143-0004-f900-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"1e29c75766b0f0f3","TraceId":"1ca6478d95e55337d0e8cf3cf6e46e60","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:09.934 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 63.4907 ms <PID: 277684, Thread: 205> {"SpanId":"1e29c75766b0f0f3","TraceId":"1ca6478d95e55337d0e8cf3cf6e46e60","ParentId":"0000000000000000","RequestId":"80000143-0004-f900-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:52.388 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 70> {"SpanId":"02e67082577e0a86","TraceId":"fc615abc5d75ec1019af7228d004d534","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"800000dc-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:11:52.681 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625799 responded 500 in 1453.5366 ms <PID: 277684, Thread: 70> {"SpanId":"02e67082577e0a86","TraceId":"fc615abc5d75ec1019af7228d004d534","ParentId":"0000000000000000","RequestId":"800000dc-0007-f900-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:11:52.697 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 70> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"800000dc-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"02e67082577e0a86","TraceId":"fc615abc5d75ec1019af7228d004d534","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:11:52.886 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"800000dc-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"02e67082577e0a86","TraceId":"fc615abc5d75ec1019af7228d004d534","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:11:53.243 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17942340947119440067", Request ID "800000dc-0007-f900-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 70> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"800000dc-0007-f900-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"02e67082577e0a86","TraceId":"fc615abc5d75ec1019af7228d004d534","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:12:09.025 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000302-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"69066fb85eaccec1","TraceId":"c459b8e1c258007c6dc0ae4082e52d2a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:09.026 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 128> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000302-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"69066fb85eaccec1","TraceId":"c459b8e1c258007c6dc0ae4082e52d2a","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:09.027 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 128> {"SpanId":"69066fb85eaccec1","TraceId":"c459b8e1c258007c6dc0ae4082e52d2a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000302-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:09.652 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 128> {"SpanId":"69066fb85eaccec1","TraceId":"c459b8e1c258007c6dc0ae4082e52d2a","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000302-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:12:09.821 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 849.7902 ms <PID: 277684, Thread: 274> {"SpanId":"69066fb85eaccec1","TraceId":"c459b8e1c258007c6dc0ae4082e52d2a","ParentId":"0000000000000000","RequestId":"80000302-0000-fa00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:09.866 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 274> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800000b4-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"4f57b2672547f548","TraceId":"e39b366e94a2e4bd81c866988c26876e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:09.867 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 274> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"800000b4-0005-fc00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"4f57b2672547f548","TraceId":"e39b366e94a2e4bd81c866988c26876e","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:09.891 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 48.0297 ms <PID: 277684, Thread: 128> {"SpanId":"4f57b2672547f548","TraceId":"e39b366e94a2e4bd81c866988c26876e","ParentId":"0000000000000000","RequestId":"800000b4-0005-fc00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:52.438 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 112> {"SpanId":"02317ecf5f3637eb","TraceId":"d5b3510e34b510be711458977a6aa96f","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000048a-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:12:52.713 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625801 responded 500 in 1485.8050 ms <PID: 277684, Thread: 112> {"SpanId":"02317ecf5f3637eb","TraceId":"d5b3510e34b510be711458977a6aa96f","ParentId":"0000000000000000","RequestId":"8000048a-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:12:52.730 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 112> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000048a-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"02317ecf5f3637eb","TraceId":"d5b3510e34b510be711458977a6aa96f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:12:52.742 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 112> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000048a-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"02317ecf5f3637eb","TraceId":"d5b3510e34b510be711458977a6aa96f","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:12:53.149 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "8000048a-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 112> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000048a-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"02317ecf5f3637eb","TraceId":"d5b3510e34b510be711458977a6aa96f","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:13:09.032 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 48> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000304-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"d72efd6fdb1b0669","TraceId":"676bc7a698c6b653a4a5eef82ad9d061","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:09.033 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 48> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"80000304-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"d72efd6fdb1b0669","TraceId":"676bc7a698c6b653a4a5eef82ad9d061","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:09.034 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 48> {"SpanId":"d72efd6fdb1b0669","TraceId":"676bc7a698c6b653a4a5eef82ad9d061","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000304-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:09.599 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 48> {"SpanId":"d72efd6fdb1b0669","TraceId":"676bc7a698c6b653a4a5eef82ad9d061","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"80000304-0000-fa00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:13:09.748 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 763.0172 ms <PID: 277684, Thread: 63> {"SpanId":"d72efd6fdb1b0669","TraceId":"676bc7a698c6b653a4a5eef82ad9d061","ParentId":"0000000000000000","RequestId":"80000304-0000-fa00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:09.803 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 97> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000006a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"494f0810558eb08d","TraceId":"053bbe0e8a57579b97922091af812dba","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:09.804 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 97> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000006a-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"494f0810558eb08d","TraceId":"053bbe0e8a57579b97922091af812dba","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:09.829 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 55.2850 ms <PID: 277684, Thread: 274> {"SpanId":"494f0810558eb08d","TraceId":"053bbe0e8a57579b97922091af812dba","ParentId":"0000000000000000","RequestId":"8000006a-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:52.415 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 7> {"SpanId":"49a2e9be26e03581","TraceId":"b1a319423b27b6b6b89893e70d25aac1","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"8000048b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:13:52.716 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625803 responded 500 in 1488.1270 ms <PID: 277684, Thread: 7> {"SpanId":"49a2e9be26e03581","TraceId":"b1a319423b27b6b6b89893e70d25aac1","ParentId":"0000000000000000","RequestId":"8000048b-0004-f600-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:13:52.732 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 7> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"8000048b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"49a2e9be26e03581","TraceId":"b1a319423b27b6b6b89893e70d25aac1","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
2022-12-08 16:13:52.743 +02:00 [WRN] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: The response has already started, the error handler will not be executed. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ResponseStarted"},"RequestId":"8000048b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"49a2e9be26e03581","TraceId":"b1a319423b27b6b6b89893e70d25aac1","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:13:53.186 +02:00 [ERR] Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer: Connection ID "17726168152120755312", Request ID "8000048b-0004-f600-b63f-84710c7967bb": An unhandled exception was thrown by the application. <PID: 277684, Thread: 7> {"EventId":{"Id":2,"Name":"ApplicationError"},"RequestId":"8000048b-0004-f600-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"49a2e9be26e03581","TraceId":"b1a319423b27b6b6b89893e70d25aac1","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
   at SysAdmin.TenantWeb.Startup.<>c.<<Configure>b__9_4>d.MoveNext() in C:\gerrit\UMP\SysAdmin.Tenant\Startup.cs:line 889
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Builder.Extensions.UsePathBaseMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2022-12-08 16:14:08.923 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 46> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000006c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"e153c8406f5be2a2","TraceId":"c33bdf17fc156240ba56287f18b5642c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:14:08.923 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 46> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"RequestId":"8000006c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","SpanId":"e153c8406f5be2a2","TraceId":"c33bdf17fc156240ba56287f18b5642c","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:14:08.924 +02:00 [DBG] SysAdmin.TenantWeb.Controllers.ApiTenant2Controller: Get Called <PID: 277684, Thread: 46> {"SpanId":"e153c8406f5be2a2","TraceId":"c33bdf17fc156240ba56287f18b5642c","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000006c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:14:09.415 +02:00 [ERR] SysAdmin.TenantLib.TenantDal: exception when counting active users per pstnGateway <PID: 277684, Thread: 46> {"SpanId":"e153c8406f5be2a2","TraceId":"c33bdf17fc156240ba56287f18b5642c","ParentId":"0000000000000000","ActionId":"7b939828-cc9b-4a66-b23e-c6014683bc33","ActionName":"SysAdmin.TenantWeb.Controllers.ApiTenant2Controller.Get (SysAdmin.TenantWeb)","RequestId":"8000006c-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/Tenant","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.ProdVer":"15.00.2000","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"208","HelpLink.BaseHelpUrl":"https://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Source":"Core .Net SqlClient Data Provider","Errors":[{"Source":"Core .Net SqlClient Data Provider","Number":208,"State":1,"Class":16,"Server":"localhost\\SQLSYSADMIN","Message":"Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.","Procedure":"","LineNumber":1}],"ClientConnectionId":"422c4fcc-eda6-45d6-b336-6c3b2818e033","Class":16,"LineNumber":1,"Number":208,"Procedure":"","Server":"localhost\\SQLSYSADMIN","State":1,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"System.Data.SqlClient.SqlException"},"Application":"SysAdmin.TenantWeb"}
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'AC_VIEW_COUNT_USED_DID_BY_TENANT_AND_SITE_LOCATION'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Dapper.SqlMapper.ExecuteReaderWithFlagsFallback(IDbCommand cmd, Boolean wasClosed, CommandBehavior behavior) in /_/Dapper/SqlMapper.cs:line 1064
   at Dapper.SqlMapper.QueryImpl[T](IDbConnection cnn, CommandDefinition command, Type effectiveType)+MoveNext() in /_/Dapper/SqlMapper.cs:line 1083
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Dapper.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 725
   at Dapper.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) in /_/Dapper/SqlMapper.cs:line 652
   at SysAdmin.TenantLib.TenantDal.GetUsedDIDCountInPstnGateway(Guid id, SysAdminInfo sysAdminInfo) in C:\gerrit\UMP\SysAdmin.TenantLib\dal\TenantDal.cs:line 1046
ClientConnectionId:422c4fcc-eda6-45d6-b336-6c3b2818e033
Error Number:208,State:1,Class:16
2022-12-08 16:14:09.550 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/Tenant responded 200 in 650.9637 ms <PID: 277684, Thread: 152> {"SpanId":"e153c8406f5be2a2","TraceId":"c33bdf17fc156240ba56287f18b5642c","ParentId":"0000000000000000","RequestId":"8000006c-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:14:09.579 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie 'idsrv.session' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 152> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000006e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"290898be141968d0","TraceId":"8da9f03ea2d4ccdc617ec23dc2b4a71d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:14:09.580 +02:00 [WRN] Microsoft.AspNetCore.Http.ResponseCookies: The cookie '.AspNetCore.Identity.Application' has set 'SameSite=None' and must also set 'Secure'. <PID: 277684, Thread: 152> {"EventId":{"Id":1,"Name":"SameSiteNotSecure"},"ActionId":"297a6d08-9aa6-4b05-921b-7d85b94706f2","ActionName":"SysAdmin.TenantWeb.Controllers.api.ApiPeeringController.Get (SysAdmin.TenantWeb)","RequestId":"8000006e-0002-ed00-b63f-84710c7967bb","RequestPath":"/tenantui/api/v1/peering/leadCounts/24","SpanId":"290898be141968d0","TraceId":"8da9f03ea2d4ccdc617ec23dc2b4a71d","ParentId":"0000000000000000","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:14:09.598 +02:00 [INF] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/api/v1/peering/leadCounts/24 responded 200 in 34.5554 ms <PID: 277684, Thread: 229> {"SpanId":"290898be141968d0","TraceId":"8da9f03ea2d4ccdc617ec23dc2b4a71d","ParentId":"0000000000000000","RequestId":"8000006e-0002-ed00-b63f-84710c7967bb","Application":"SysAdmin.TenantWeb"}
2022-12-08 16:14:52.413 +02:00 [ERR] SysAdmin.TenantWeb.Controllers.ProxyController: OnActionExecutionAsync <PID: 277684, Thread: 122> {"SpanId":"3c454008ff95da45","TraceId":"794ac9b2c1140e7349edb4ff44b8fd03","ParentId":"0000000000000000","ActionId":"58aa01f1-187d-4ce4-b486-aee3f1197aa2","ActionName":"SysAdmin.TenantWeb.Controllers.ProxyController.Get (SysAdmin.TenantWeb)","RequestId":"80000681-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","ExceptionDetail":{"HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it. (127.0.0.1:4147)","Source":"System.Net.Http","InnerException":{"Type":"System.Net.Sockets.SocketException","HResult":-2147467259,"Message":"No connection could be made because the target machine actively refused it.","Source":"System.Net.Sockets","SocketErrorCode":"ConnectionRefused","SocketErrorCodeMessage":"The remote host is actively refusing a connection."},"StatusCode":null,"Type":"System.Net.Http.HttpRequestException"},"Application":"SysAdmin.TenantWeb"}
System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it. (127.0.0.1:4147)
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|283_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.DefaultConnectAsync(SocketsHttpConnectionContext context, CancellationToken cancellationToken)
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.ConnectHelper.ConnectAsync(Func`3 callback, DnsEndPoint endPoint, HttpRequestMessage requestMessage, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.GetHttpConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.SendAsyncCore(HttpRequestMessage request, HttpCompletionOption completionOption, Boolean async, Boolean emitTelemetryStartStop, CancellationToken cancellationToken)
   at SysAdmin.TenantWeb.Controllers.ProxyController.OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) in C:\gerrit\UMP\SysAdmin.Tenant\Areas\SysAdmin\Controllers\Proxy\ProxyController.cs:line 106
2022-12-08 16:14:52.686 +02:00 [ERR] Serilog.AspNetCore.RequestLoggingMiddleware: HTTP GET /tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus?_=1670498625805 responded 500 in 1456.9671 ms <PID: 277684, Thread: 122> {"SpanId":"3c454008ff95da45","TraceId":"794ac9b2c1140e7349edb4ff44b8fd03","ParentId":"0000000000000000","RequestId":"80000681-0005-fb00-b63f-84710c7967bb","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-12-08 16:14:52.698 +02:00 [ERR] Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware: An unhandled exception has occurred while executing the request. <PID: 277684, Thread: 122> {"EventId":{"Id":1,"Name":"UnhandledException"},"RequestId":"80000681-0005-fb00-b63f-84710c7967bb","RequestPath":"/tenantui/SysAdmin/addbe6c2-cbb5-4d6a-913c-1c64c90f8b14/api/proxy/psqueue/jobStatus","SpanId":"3c454008ff95da45","TraceId":"794ac9b2c1140e7349edb4ff44b8fd03","ParentId":"0000000000000000","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"StatusCode cannot be set because the response has already started.","Source":"Microsoft.AspNetCore.Server.IIS"},"Application":"SysAdmin.TenantWeb"}
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.ThrowResponseAlreadyStartedException(String name)
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Mvc.ActionResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at SysAdmin.TenantWeb.Middleware.SwaggerAuthorizedMiddleware.InvokeAsync(HttpContext context) in C:\gerrit\UMP\SysAdmin.Tenant\Middleware\SwaggerAuthorizedMiddleware.cs:line 34
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.<Invoke>g__Awaited|6_0(ExceptionHandlerMiddleware middleware, HttpContext context, Task task)
